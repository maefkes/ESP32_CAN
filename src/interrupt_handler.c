/**************************************************************************
interrupt_handler.c
 Created on: Feb 28, 2026
     Author: M. Schermutzki
*************************************************************************/
/*** includes *************************************************************/
#include <assert.h>
#include <stdbool.h>
#include <Arduino.h>
/*** local constants ******************************************************/
/*** structures ***********************************************************/
/*** local constants ******************************************************/
/*** macros ***************************************************************/
/*** local variables ******************************************************/
static bool _initialized = false;
static uint8_t _irqCount = 0;
/*** prototypes ***********************************************************/
/*** interrupt service routines *******************************************/
/*** functions ************************************************************/
/***************************************************************************
 * This function 
 **************************************************************************/
void interrupt_handler_leaveCritical(void)
{
	if (_irqCount > 0)
	{
		_irqCount--;

		if(_irqCount == 0)
		{
			interrupts();
		}
	}
}
/***************************************************************************
 * This function 
 **************************************************************************/
void interrupt_handler_enterCritical(void)
{
	if(_irqCount == 0)
	{
		noInterrupts();
	}
	_irqCount++;
}
/***************************************************************************
 * This function 
 **************************************************************************/
void interrupt_handler_init(void)
{
    if(!_initialized)
    {
        _initialized = true;
    }
}

